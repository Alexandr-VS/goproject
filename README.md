# Генератор и приёмник пакетов

Генератор пакетов предназначен для создания и отправки сетевых пакетов. Он позволяет настраивать различные параметры пакетов, такие как протоколы, порты, адреса и их содержимое. 
Приёмник пакетов позволяет захватывать и анализировать сетевые пакеты.

## Установка

1. Убедитесь, что у вас установлен Go. Для этого можно использовать команду командной строки:
```bash
go
```
Если Go не установлен, воспользуйтесь руководством по его установке: https://go.dev/doc/install

2. Клонируйте себе репозиторий:
```bash
git clone https://github.com/Alexandr-VS/goproject
```

3. Перейдите в директорию проекта с помощью команды:
```bash
cd ./директория, в которую клонировали репозиторий
```

4. Установите зависимости командой:
```bash
go mod tidy
```

5. Понадобится библиотека pcap.h, чтобы её установить, введите команду в командной строке:
```bash
sudo apt-get install libpcap0.8-dev
```

6. Для запуска необходимы права привилегированного пользователя:
```bash
sudo bash
```

7. Убедиться, что поддерживается Go:
```bash
go
```
Если не поддерживается, необходимо в том же привилегированном режиме выполнить следующие команды:
```bash
nano ~/.bashrc
```
В открывшемся текстовом редакторе в конце файла добавить следующие строки:

```
export PATH=$PATH:/usr/local/go/bin
export GOPATH=$HOME/goproject
export PATH=$PATH:$GOPATH/bin
```
Сохранить изменения комбинацией клавиш: Ctrl+O, Enter, Ctrl+X.
Выполнить команду от привилегированного пользователя
```bash
source ~/.bashrc
```

Проверить, что команда ```go``` работает.

8. Запустить receiver и generator из соответствующих директорий:
```bash
go run main.go
```

## Использование

### Генератор пакетов

Создаётся пакет, для которого можно указать различные параметры, такие как MAC-адреса, IP-адреса, порты отправителя и получателя, а также указать полезную нагрузку пакетов (данные). Для изменения размера полезной нагрузки есть параметр ```payloadSize```, в котором размер указывается в байтах. В проекте полезная нагрузка заполняется случайными данными ```and.Read(payload)```. 
Для изменения скорости отправки пакетов в сеть:
```Go
desiredBandwidth := 10_000_000 // 10 Мбит/с

	packetSizeInBits := payloadSize * 8 // размер пакета в битах

	packetsPerSecond := desiredBandwidth / packetSizeInBits // количество генерируемых пакетов в секунду

	interval := time.Second / time.Duration(packetsPerSecond) // время, через которое необходимо отправлять каждый пакет

	ticker := time.NewTicker(interval)
```

### Приёмник

При получении пакетов есть возможность обрабатывать только с определённым IP-адресом, изменив в функции handle.SetBPFFilter IP-адрес на необходимый:
```Go
if handle, err := pcap.OpenLive("eth0", 1600, true, pcap.BlockForever); err != nil {
		panic(err)
} else if err := handle.SetBPFFilter("host 127.0.0.1"); err != nil {
		panic(err)
}
```

При обработке пакетов выводятся IP-адреса и порты отправителя и получателя. Определяется, какой протокол транспортного уровня использовался. А также выводится полезная нагрузка, если она присутствует в пакете.
